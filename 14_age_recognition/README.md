# Описание проекта

**Цель исследования** - построить модель для решения задачи регрессии, которая бы определяла приблизительный возраст человека по его фотографии.

В перспективе данная модель могла бы быть использована в сетях розничной торговли - фотофиксация в прикассовой зоне и система компьютерного зрения для обработки фотографий покупателей поможет определять возраст клиентов, чтобы:

- Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- Контролировать добросовестность кассиров при продаже алкоголя.

# Описание данных

В качестве **материала исследования** используется выборка с фотографиями людей и указанием их реального возраста:
 
- `file_name` - наименование изображения;
- `real_age` - реальный возраст изображенного на фото человека.

# Ход исследования

В данном исследовании перед нами стоят следующие задачи:

- провести исследовательский анализ данных: посмотреть, с камими изображениями будем иметь дело; как распределен реальный возраст людей на фотографиях; проверить, есть ли пропуски в данных; проанализовать размер выборки и т.д.

- подготовить данные к обучению: создадать загрузчик, который выгрузит данные из папки и сформирует батчи с изображениями и метками возраста; нормировать яркость пикселей; разделить данные на тренировочные и тестовые.

- обучить нейронную сеть и оценить ее качество.

# Стэк

Pandas, Matplotlib, Seaborn, Keras.

# Выводы

Для обучения модели была использована сеть ResNet50, предобученная на ImageNet, чтобы улучить качество нашей модели.
Последние два слоя (GlobalAveragePooling2D и Dense) не были включены в костяк сети ResNet50, т.к. слой с 1000 нейронами нам не нужен.

В конце самой модели есть два слоя - GlobalAveragePooling2D и Dense: 

- GlobalAveragePooling2D - пулинг с окном во весь тензор, возвращает среднее значение из группы пикселей внутри канала. GlobalAveragePooling2D нужен, чтобы усреднить информацию по всему изображению;

- полносвязный слой с 1 нейроном, т.к. больше нам и не нужно, нам нужно вернуть число, а не разбить изображения на классы.

В качестве функции потерь в модели использована Mean Squared Error, т.к. зачастую нейронные сети с данной функцией потерь обучаются быстрее.

Качество модели оцениваем по метрике Mean Absolute Error, т.к. нам важен диапазон разброса предсказаний модели.

Чтобы подбор шага был автоматическим, применяли алгоритм Adam (он подбирает различные параметры для разных нейронов, что также ускоряет обучение модели). В параметре алгоритма снизили скорость обучения до 0,0001, чтобы улучшить итоговое качество модели.

В результате обучения получили модель, которая определяет возраст человека на фотографии со средней ошибкой в 6 лет. Такого результата недостаточно для того, чтобы определять, совершеннолетний перед нами человек или нет, но такого результата может быть достаточно для определения возрастной группы, чтобы анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы.
